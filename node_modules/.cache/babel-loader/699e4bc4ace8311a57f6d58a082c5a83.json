{"ast":null,"code":"import { watch } from 'vue';\nimport { on } from 'element-plus/es/utils/dom';\nimport { EVENT_CODE } from 'element-plus/es/utils/aria';\nimport isServer from 'element-plus/es/utils/isServer';\nconst modalStack = [];\n\nconst closeModal = e => {\n  if (modalStack.length === 0) return;\n\n  if (e.code === EVENT_CODE.esc) {\n    e.stopPropagation();\n    const topModal = modalStack[modalStack.length - 1];\n    topModal.handleClose();\n  }\n};\n\nexport default ((instance, visibleRef) => {\n  watch(() => visibleRef.value, val => {\n    if (val) {\n      modalStack.push(instance);\n    } else {\n      modalStack.splice(modalStack.findIndex(modal => modal === instance), 1);\n    }\n  });\n});\n\nif (!isServer) {\n  on(document, 'keydown', closeModal);\n}","map":{"version":3,"names":["watch","on","EVENT_CODE","isServer","modalStack","closeModal","e","length","code","esc","stopPropagation","topModal","handleClose","instance","visibleRef","value","val","push","splice","findIndex","modal","document"],"sources":["/home/haibara/ghq/github.com/w-haibara/kakemoti-ui/node_modules/element-plus/es/hooks/use-modal/index.js"],"sourcesContent":["import { watch } from 'vue';\nimport { on } from 'element-plus/es/utils/dom';\nimport { EVENT_CODE } from 'element-plus/es/utils/aria';\nimport isServer from 'element-plus/es/utils/isServer';\nconst modalStack = [];\nconst closeModal = (e) => {\n    if (modalStack.length === 0)\n        return;\n    if (e.code === EVENT_CODE.esc) {\n        e.stopPropagation();\n        const topModal = modalStack[modalStack.length - 1];\n        topModal.handleClose();\n    }\n};\nexport default (instance, visibleRef) => {\n    watch(() => visibleRef.value, (val) => {\n        if (val) {\n            modalStack.push(instance);\n        }\n        else {\n            modalStack.splice(modalStack.findIndex((modal) => modal === instance), 1);\n        }\n    });\n};\nif (!isServer) {\n    on(document, 'keydown', closeModal);\n}\n"],"mappings":"AAAA,SAASA,KAAT,QAAsB,KAAtB;AACA,SAASC,EAAT,QAAmB,2BAAnB;AACA,SAASC,UAAT,QAA2B,4BAA3B;AACA,OAAOC,QAAP,MAAqB,gCAArB;AACA,MAAMC,UAAU,GAAG,EAAnB;;AACA,MAAMC,UAAU,GAAIC,CAAD,IAAO;EACtB,IAAIF,UAAU,CAACG,MAAX,KAAsB,CAA1B,EACI;;EACJ,IAAID,CAAC,CAACE,IAAF,KAAWN,UAAU,CAACO,GAA1B,EAA+B;IAC3BH,CAAC,CAACI,eAAF;IACA,MAAMC,QAAQ,GAAGP,UAAU,CAACA,UAAU,CAACG,MAAX,GAAoB,CAArB,CAA3B;IACAI,QAAQ,CAACC,WAAT;EACH;AACJ,CARD;;AASA,gBAAe,CAACC,QAAD,EAAWC,UAAX,KAA0B;EACrCd,KAAK,CAAC,MAAMc,UAAU,CAACC,KAAlB,EAA0BC,GAAD,IAAS;IACnC,IAAIA,GAAJ,EAAS;MACLZ,UAAU,CAACa,IAAX,CAAgBJ,QAAhB;IACH,CAFD,MAGK;MACDT,UAAU,CAACc,MAAX,CAAkBd,UAAU,CAACe,SAAX,CAAsBC,KAAD,IAAWA,KAAK,KAAKP,QAA1C,CAAlB,EAAuE,CAAvE;IACH;EACJ,CAPI,CAAL;AAQH,CATD;;AAUA,IAAI,CAACV,QAAL,EAAe;EACXF,EAAE,CAACoB,QAAD,EAAW,SAAX,EAAsBhB,UAAtB,CAAF;AACH"},"metadata":{},"sourceType":"module"}